/**
 * EasyUI for Angular 0.3
 * 
 * Copyright (c) 2009-2017 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the freeware license: https://www.jeasyui.com/license_freeware2.php
 * To use it on other terms please contact us: info@jeasyui.com
 *
 */
var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();import{Component,forwardRef,Input,HostListener}from"@angular/core";import{NG_VALUE_ACCESSOR}from"@angular/forms";import{SpinnerBaseComponent,SPINNER_BASE_TEMPLATE}from"../base/spinner-base.component";import{dateHelper}from"../base/datehelper";var TimeSpinnerComponent=function(_super){function TimeSpinnerComponent(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.min=null,_this.max=null,_this.increment=1,_this.highlight=0,_this.formatter=_this.defaultFormatter,_this.parser=_this.defaultParser,_this.selections=[[0,2],[3,5],[6,8]],_this.highlighting=!1,_this.inputingText=null,_this._text=null,_this._format="HH:mm",_this}return __extends(TimeSpinnerComponent,_super),Object.defineProperty(TimeSpinnerComponent.prototype,"text",{get:function(){var _this=this;return this._text=this._focused?this._text:this.textFormatter(this.value),this.focused&&this.highlighting&&(this.highlightRange(this.highlight),setTimeout(function(){return _this.highlighting=!1})),this._text},set:function(value){this._text=value,this.focused&&(this.inputingText=value)},enumerable:!0,configurable:!0}),Object.defineProperty(TimeSpinnerComponent.prototype,"format",{get:function(){return this._format},set:function(value){this._format=value,this.selections=dateHelper.parseSelections(this._format)},enumerable:!0,configurable:!0}),TimeSpinnerComponent.prototype._defaultTextFormatter=function(value){return this.formatter(this.parser(value))},TimeSpinnerComponent.prototype._transform=function(value){return this._initialized?this.formatter(this.parser(value)):value},TimeSpinnerComponent.prototype.ngOnInit=function(){_super.prototype.ngOnInit.call(this),this.selections=dateHelper.parseSelections(this._format)},TimeSpinnerComponent.prototype.onClickMe=function(event){if(event.target==this.inputRef.nativeElement)for(var start=this.getSelectionStart(),i=0;i<this.selections.length;i++){var range=this.selections[i];if(start>=range[0]&&start<=range[1])return void this.highlightRange(i)}},TimeSpinnerComponent.prototype.onPressMe=function(event){event.target==this.inputRef.nativeElement&&13==event.keyCode&&(event.stopPropagation(),this.value=this.text,this.text=this.value,this.onClickMe(event),this.highlighting=!0)},TimeSpinnerComponent.prototype.onTimeSpinnerBlur=function(){null!=this.inputingText&&(this.value=this.inputingText,this.inputingText=null)},TimeSpinnerComponent.prototype.doSpin=function(down){var range=this.selections[this.highlight];if(range){var s=this.text||"";if(s){var s1=s.substring(0,range[0]),s2=s.substring(range[0],range[1]),s3=s.substring(range[1]),v=s1+((parseInt(s2,10)||0)+this.increment*(down?-1:1))+s3;this.value=this.formatter(this.parser(v))}else this.value=this.formatter(new Date);this.text=this.value,this.focus(),this.highlighting=!0}},TimeSpinnerComponent.prototype.doSpinUp=function(){this.doSpin(!1)},TimeSpinnerComponent.prototype.doSpinDown=function(){this.doSpin(!0)},TimeSpinnerComponent.prototype.highlightRange=function(index){this.highlight=index;var range=this.selections[this.highlight];range&&(this.setSelectionRange(range[0],range[1]),this.focus())},TimeSpinnerComponent.prototype.parseD=function(value){return dateHelper.parseDate(value,this.format)},TimeSpinnerComponent.prototype.defaultFormatter=function(date){return dateHelper.formatDate(date,this.format)},TimeSpinnerComponent.prototype.defaultParser=function(value){var date=this.parseD(value);if(date){var min=this.parseD(this.min),max=this.parseD(this.max);min&&min>date&&(date=min),max&&max<date&&(date=max)}return date},TimeSpinnerComponent}(SpinnerBaseComponent);export{TimeSpinnerComponent};TimeSpinnerComponent.decorators=[{type:Component,args:[{selector:"eui-timespinner",template:SPINNER_BASE_TEMPLATE,providers:[{provide:NG_VALUE_ACCESSOR,useExisting:forwardRef(function(){return TimeSpinnerComponent}),multi:!0}],host:{"[class.f-inline-row]":"true"}}]}],TimeSpinnerComponent.ctorParameters=function(){return[]},TimeSpinnerComponent.propDecorators={min:[{type:Input}],max:[{type:Input}],increment:[{type:Input}],highlight:[{type:Input}],formatter:[{type:Input}],parser:[{type:Input}],selections:[{type:Input}],text:[{type:Input}],format:[{type:Input}],onClickMe:[{type:HostListener,args:["click",["$event"]]}],onPressMe:[{type:HostListener,args:["keydown",["$event"]]}],onTimeSpinnerBlur:[{type:HostListener,args:["blur"]}]};